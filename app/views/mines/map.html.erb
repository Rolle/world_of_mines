<div class="container bs-docs-container">
    <div class="row">
        <div class="col-md-12" role="main">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3>Karte</b></h3>
                </div>
                <div class="panel-body">
                    <div id ="map" style="width:auto; height: 700px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>

<script type='text/javascript'>   

    function onClick(e) {
        alert(this.getLatLng());
    }
        <% if Rails.env.production? %>
                L.Icon.Default.imagePath = '/';
        <% else %>
                L.Icon.Default.imagePath = '<%= asset_path "" %>';
        <% end %>
        var redMarker = L.AwesomeMarkers.icon({
                  icon: 'search', 
                  markerColor: 'red',
                  prefix: 'fa'
        })

        map = new L.Map('map');
        map.setView(new L.LatLng(49.77477900007886,6.80334), 12);

        var osmde = L.tileLayer.provider('OpenStreetMap.DE');
        var ggl = new L.Google();
        var bing = new L.BingLayer("ApiJPrwDWWqUlXoy7gg460DQBa55V-i1XqWWQfnf1sz5HW4CfxUkBZ7afjaMtQ5W");
        
        var baseMaps = {
                "Google": ggl,
                "Bing": bing,
                "OSM DE": osmde,
        };
        var markers_main = new L.MarkerClusterGroup();
        var overlayMaps = {
            "Gruben": markers_main,
        };
        //L.control.layers(baseMaps, overlayMaps).addTo(map);
        map.addLayer(bing);
        //map.addLayer(osmde);
        map.addLayer(markers_main);
        //map.addLayer(baseMaps);
        
        <% if @mines %>
                <% @mines.each do |mine| %>
                        var marker = L.marker([<%= mine.latitude %>, <%= mine.longitude %>], {icon: redMarker});//.addTo(map);
                        markers_main.addLayer(marker); 
                        marker.on('click', onClick);
                        /*var divNode = document.createElement("div");   
                        divNode.innerHTML = '<%= raw create_popup(mine)%>';
                        marker.bindPopup(divNode);*/
                <% end %>
        <% end %>

        enable_top_menu("karte");
</script> 